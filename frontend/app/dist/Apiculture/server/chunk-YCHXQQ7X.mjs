import './polyfills.server.mjs';
import{b as ie}from"./chunk-YYI5FG2Y.mjs";import{a as L}from"./chunk-IFDW36NG.mjs";import{d as ne,e as u,f as oe,g as re,i as ae,j as le,k as de,l as ce,m as me,n as se,o as ue,p as pe,r as ge,v as he,w as fe,x as ve}from"./chunk-XUNESROI.mjs";import{Ba as J,Cb as X,Db as Z,Ga as v,H as A,Ia as b,Jb as ee,Kb as te,M as q,P as a,R as p,S as B,Sa as $,W as y,ba as w,ca as G,da as j,ga as R,gb as U,ha as W,ia as m,ja as n,jb as Y,ka as e,la as s,lb as K,ma as H,na as h,oa as O,ob as _,qa as M,s as S,sa as o,t as I,ta as Q,u as D,ua as f,xa as F,ya as T,za as N}from"./chunk-N2JQ4MHT.mjs";import{a as V,b as z}from"./chunk-T55IDOPT.mjs";var _e=(l,r)=>r.id;function Ce(l,r){l&1&&(n(0,"p",12),o(1,"Votre panier est vide. "),n(2,"a",42),o(3,"Continuez vos achats"),e(),o(4,"."),e())}function ye(l,r){if(l&1){let t=H();n(0,"tr")(1,"td"),s(2,"img",45),e(),n(3,"td",46),o(4),e(),n(5,"td",46)(6,"input",47),N("ngModelChange",function(d){let c=S(t).$implicit;return T(c.quantity,d)||(c.quantity=d),I(d)}),h("ngModelChange",function(d){let c=S(t).$implicit,g=O(2);return I(g.updateQuantity(c,d))}),e()(),n(7,"td",46),o(8),v(9,"number"),e(),n(10,"td",46),o(11),v(12,"number"),e(),n(13,"td",46)(14,"button",48),h("click",function(){let d=S(t).$implicit,c=O(2);return I(c.removeItem(d.id))}),D(),n(15,"svg",49),s(16,"path",50)(17,"path",51),e()()()()}if(l&2){let t=r.$implicit;a(2),m("src",t.image,q)("alt","Produit "+t.name+" d'Apiculture Galai"),a(2),Q(t.name),a(2),m("id",J("quantity-",t.id)),F("ngModel",t.quantity),w("aria-label","Quantit\xE9 de "+t.name),a(2),f("",b(9,10,t.price,"1.2-2")," DNT"),a(3),f("",b(12,13,t.price*t.quantity,"1.2-2")," DNT"),a(3),w("aria-label","Supprimer "+t.name+" du panier")}}function Me(l,r){if(l&1&&(n(0,"div",13)(1,"table",43)(2,"thead")(3,"tr")(4,"th",44),o(5,"Produit"),e(),n(6,"th",44),o(7,"Nom"),e(),n(8,"th",44),o(9,"Quantit\xE9"),e(),n(10,"th",44),o(11,"Prix"),e(),n(12,"th",44),o(13,"Total"),e(),s(14,"th",44),e()(),n(15,"tbody"),R(16,ye,18,16,"tr",null,_e),e()()()),l&2){let t=O();a(16),W(t.cartItems)}}function xe(l,r){l&1&&(n(0,"div",52),o(1," Veuillez entrer un nom valide (minimum 2 caract\xE8res). "),e())}function ke(l,r){l&1&&(n(0,"div",52),o(1," Veuillez entrer un email valide. "),e())}function Ee(l,r){l&1&&(n(0,"div",52),o(1," Veuillez entrer un num\xE9ro de t\xE9l\xE9phone valide (8 chiffres). "),e())}function Pe(l,r){l&1&&(n(0,"div",52),o(1," Veuillez entrer une adresse de livraison valide (minimum 5 caract\xE8res). "),e())}var be=class l{constructor(r,t,i,d,c,g,C){this.platformId=r;this.meta=t;this.title=i;this.router=d;this.fb=c;this.cdr=g;this.api=C;this.checkoutForm=this.fb.group({fullName:["",[u.required,u.minLength(2)]],email:["",[u.required,u.email]],phone:["",[u.required,u.pattern("^[0-9]{8}$")]],deliveryLocation:["",[u.required,u.minLength(5)]]})}cartItems=[];paymentMethod="online";checkoutForm;ngOnInit(){if(this.title.setTitle("Panier - Apiculture Galai"),this.meta.updateTag({name:"description",content:"Consultez et g\xE9rez votre panier chez Apiculture Galai. D\xE9couvrez nos produits apicoles de qualit\xE9."}),_(this.platformId)){let r=localStorage.getItem("cartItems");r?this.cartItems=JSON.parse(r):(this.cartItems=[],this.saveCartToLocalStorage())}_(this.platformId)&&(L.from(".panier-section",{opacity:0,y:50,duration:1,stagger:.3,ease:"power3.out",delay:.2}),L.from(".panier-img",{opacity:0,scale:.9,duration:1.2,stagger:.3,ease:"power3.out",delay:.4}))}saveCartToLocalStorage(){_(this.platformId)&&(localStorage.removeItem("cartItems"),localStorage.setItem("cartItems",JSON.stringify(this.cartItems)))}updateQuantity(r,t){t>=1&&(this.cartItems=this.cartItems.map(i=>i.id===r.id?z(V({},i),{quantity:t}):i),this.saveCartToLocalStorage(),this.cdr.detectChanges())}removeItem(r){this.cartItems=this.cartItems.filter(t=>t.id!==r),this.saveCartToLocalStorage(),this.cdr.detectChanges()}getSubtotal(){return this.cartItems.reduce((t,i)=>t+i.price*i.quantity,0)}getTax(){return this.getSubtotal()*.19}getTotal(){return this.getSubtotal()+this.getTax()}openCheckoutModal(){if(this.cartItems.length>0&&_(this.platformId)){let r=document.getElementById("checkoutModal");if(r){let t=window.bootstrap;t?new t.Modal(r).show():console.error("Bootstrap JS not loaded")}else console.error("Modal element not found");this.cdr.detectChanges()}}closeModal(){if(console.log("Closing checkout modal"),_(this.platformId)){let r=document.getElementById("checkoutModal");if(r){let t=window.bootstrap;if(t){let i=t.Modal.getInstance(r);i&&i.hide()}}}this.checkoutForm.reset(),this.cdr.detectChanges()}finalizeOrder(){if(this.checkoutForm.valid){console.log("Finalizing order:",this.checkoutForm.value);let r={total_amount:this.getTotal(),status:"pending",items:this.cartItems.map(t=>({product_id:t.id,quantity:t.quantity,price:t.price,name:t.name})),id:0,username:this.checkoutForm.value.fullName,email:this.checkoutForm.value.email,telephone:this.checkoutForm.value.phone.toString(),location:this.checkoutForm.value.deliveryLocation,payment_method:this.paymentMethod,created_at:new Date().toISOString(),code:""};this.api.createOrder(r).subscribe({next:t=>{console.log("Order created successfully:",t),this.router.navigate(["/order-confirmation",t.id]),this.cartItems=[],this.saveCartToLocalStorage()},error:t=>{console.error("Failed to create order:",t),alert("An error occurred while finalizing your order. Please try again later.")}}),this.closeModal()}}static \u0275fac=function(t){return new(t||l)(p(A),p(X),p(Z),p(ee),p(he),p($),p(ie))};static \u0275cmp=B({type:l,selectors:[["app-panier"]],decls:82,vars:29,consts:[[1,"min-h-screen"],[1,"hero","py-6","text-center","bg-light-amber","position-relative",2,"background-image","url('/assets/images/pexels-pixabay-301378.jpg')","background-size","cover","background-position","bottom"],[1,"container-md"],[1,"hero-overlay"],[1,"display-3","text-amber","mb-4","panier-section"],[1,"lead","text-success","mb-0","panier-section"],[1,"container-md","py-6"],[1,"row","g-5"],[1,"col-12","col-lg-8","panier-section"],[1,"card","shadow-sm","rounded"],[1,"card-body"],[1,"h3","text-success","mb-4"],[1,"text-dark"],[1,"table-responsive"],[1,"col-12","col-lg-4","panier-section"],[1,"text-dark","list-unstyled"],[1,"mb-2"],[1,"mb-3"],["for","paymentMethod",1,"form-label","text-dark"],["id","paymentMethod","aria-label","Choisir une m\xE9thode de paiement",1,"form-select",3,"ngModelChange","ngModel"],["value","online"],["value","cod"],["aria-label","Passer \xE0 la caisse avec Apiculture Galai",1,"btn","btn-warning","text-light","hover-dark-green","w-100","mb-3",3,"click","disabled"],["routerLink","/boutique","aria-label","Continuer les achats chez Apiculture Galai",1,"btn","btn-outline-success","w-100"],["id","checkoutModal","tabindex","-1","aria-labelledby","checkoutModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","bg-light-amber"],["id","checkoutModalLabel",1,"modal-title","text-amber"],["type","button","aria-label","Fermer",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],["for","fullName",1,"form-label","text-dark"],["type","text","id","fullName","formControlName","fullName","aria-describedby","fullNameError",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","email",1,"form-label","text-dark"],["type","email","id","email","formControlName","email","aria-describedby","emailError",1,"form-control"],["for","phone",1,"form-label","text-dark"],["type","tel","id","phone","formControlName","phone","aria-describedby","phoneError",1,"form-control"],["for","deliveryLocation",1,"form-label","text-dark"],["type","text","id","deliveryLocation","formControlName","deliveryLocation","aria-describedby","deliveryLocationError",1,"form-control"],["type","submit","aria-label","Finaliser la commande avec Apiculture Galai",1,"btn","btn-warning","text-light","hover-dark-green","w-100",3,"disabled"],["routerLink","/boutique",1,"text-success"],[1,"table","table-hover"],["scope","col"],["loading","lazy",1,"panier-img","rounded",2,"width","auto","height","80px","object-fit","cover",3,"src","alt"],[1,"align-middle"],["type","number","min","1",1,"form-control","w-25","d-inline-block",3,"ngModelChange","id","ngModel"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-trash"],["d","M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"],["d","M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"],[1,"invalid-feedback"]],template:function(t,i){if(t&1&&(n(0,"main",0)(1,"section",1)(2,"div",2),s(3,"div",3),n(4,"h1",4),o(5,"Votre Panier"),e(),n(6,"p",5),o(7,"Consultez vos produits apicoles s\xE9lectionn\xE9s et passez \xE0 la caisse avec Apiculture Galai."),e()()(),n(8,"section",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"h2",11),o(14,"Articles dans le Panier"),e(),G(15,Ce,5,0,"p",12)(16,Me,18,0,"div",13),e()()(),n(17,"div",14)(18,"div",9)(19,"div",10)(20,"h2",11),o(21,"R\xE9sum\xE9 du Panier"),e(),n(22,"ul",15)(23,"li",16)(24,"strong"),o(25,"HT :"),e(),o(26),v(27,"number"),e(),n(28,"li",16)(29,"strong"),o(30,"Taxe (19%) :"),e(),o(31),v(32,"number"),e(),n(33,"li",17)(34,"strong"),o(35,"Total :"),e(),o(36),v(37,"number"),e()(),n(38,"div",17)(39,"label",18)(40,"strong"),o(41,"M\xE9thode de paiement :"),e()(),n(42,"select",19),N("ngModelChange",function(c){return T(i.paymentMethod,c)||(i.paymentMethod=c),c}),n(43,"option",20),o(44,"Payer en ligne"),e(),n(45,"option",21),o(46,"Payer \xE0 la livraison"),e()()(),n(47,"button",22),h("click",function(){return i.openCheckoutModal()}),o(48," Commander "),e(),n(49,"a",23),o(50,"Continuer les Achats"),e()()()()()(),n(51,"div",24)(52,"div",25)(53,"div",26)(54,"div",27)(55,"h5",28),o(56,"Finaliser votre commande"),e(),n(57,"button",29),h("click",function(){return i.closeModal()}),e()(),n(58,"div",30)(59,"form",31),h("ngSubmit",function(){return i.finalizeOrder()}),n(60,"div",17)(61,"label",32),o(62,"Nom complet"),e(),s(63,"input",33),y(64,xe,2,0,"div",34),e(),n(65,"div",17)(66,"label",35),o(67,"Email"),e(),s(68,"input",36),y(69,ke,2,0,"div",34),e(),n(70,"div",17)(71,"label",37),o(72,"Num\xE9ro de t\xE9l\xE9phone"),e(),s(73,"input",38),y(74,Ee,2,0,"div",34),e(),n(75,"div",17)(76,"label",39),o(77,"Lieu de livraison"),e(),s(78,"input",40),y(79,Pe,2,0,"div",34),e(),n(80,"button",41),o(81," Finaliser la commande "),e()()()()()()()),t&2){let d,c,g,C,x,k,E,P;a(15),j(i.cartItems.length===0?15:16),a(11),f(" ",b(27,20,i.getSubtotal(),"1.2-2")," DNT"),a(5),f(" ",b(32,23,i.getTax(),"1.2-2")," DNT"),a(5),f(" ",b(37,26,i.getTotal(),"1.2-2")," DNT"),a(6),F("ngModel",i.paymentMethod),a(5),m("disabled",i.cartItems.length===0),a(12),m("formGroup",i.checkoutForm),a(4),M("is-invalid",((d=i.checkoutForm.get("fullName"))==null?null:d.invalid)&&((d=i.checkoutForm.get("fullName"))==null?null:d.touched)),a(),m("ngIf",((c=i.checkoutForm.get("fullName"))==null?null:c.invalid)&&((c=i.checkoutForm.get("fullName"))==null?null:c.touched)),a(4),M("is-invalid",((g=i.checkoutForm.get("email"))==null?null:g.invalid)&&((g=i.checkoutForm.get("email"))==null?null:g.touched)),a(),m("ngIf",((C=i.checkoutForm.get("email"))==null?null:C.invalid)&&((C=i.checkoutForm.get("email"))==null?null:C.touched)),a(4),M("is-invalid",((x=i.checkoutForm.get("phone"))==null?null:x.invalid)&&((x=i.checkoutForm.get("phone"))==null?null:x.touched)),a(),m("ngIf",((k=i.checkoutForm.get("phone"))==null?null:k.invalid)&&((k=i.checkoutForm.get("phone"))==null?null:k.touched)),a(4),M("is-invalid",((E=i.checkoutForm.get("deliveryLocation"))==null?null:E.invalid)&&((E=i.checkoutForm.get("deliveryLocation"))==null?null:E.touched)),a(),m("ngIf",((P=i.checkoutForm.get("deliveryLocation"))==null?null:P.invalid)&&((P=i.checkoutForm.get("deliveryLocation"))==null?null:P.touched)),a(),m("disabled",i.checkoutForm.invalid)}},dependencies:[K,U,Y,fe,le,ue,pe,ne,de,se,oe,re,ge,ae,ve,ce,me,te],styles:["main[_ngcontent-%COMP%]{background-color:#fff8e1;font-family:Roboto,sans-serif}.hero[_ngcontent-%COMP%]{height:280px;display:flex;align-items:center;position:relative;background-color:#f5f1e07e;padding-top:8rem;padding-bottom:8rem}.hero-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#00000080;z-index:1}.hero[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .hero[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{position:relative;z-index:2;text-shadow:0 2px 4px rgba(0,0,0,.2)}.card[_ngcontent-%COMP%]{border:none;transition:transform .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.table[_ngcontent-%COMP%]{background-color:#fff}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-color:#d97706;background-color:#fff8e1;min-width:60px}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#14532d;box-shadow:0 0 0 .2rem #14532d40}.text-success[_ngcontent-%COMP%]{color:#15803d!important}.text-success[_ngcontent-%COMP%]:hover{color:#1ec962!important}.text-amber[_ngcontent-%COMP%]{color:#d97706!important}.btn-warning[_ngcontent-%COMP%]{background-color:#d97706;border-color:#d97706;padding:.75rem 2rem}.btn-warning[_ngcontent-%COMP%]:hover, .hover-dark-green[_ngcontent-%COMP%]:hover{background-color:#14532d;border-color:#14532d}.btn-outline-success[_ngcontent-%COMP%]{border-color:#15803d;color:#15803d}.btn-outline-success[_ngcontent-%COMP%]:hover{background-color:#14532d;color:#fff}.bg-light-amber[_ngcontent-%COMP%]{background-color:#fff8e1}.bg-gradient-amber[_ngcontent-%COMP%]{background:linear-gradient(180deg,#fff8e1,#f5e0b5)}.text-dark[_ngcontent-%COMP%]{color:#333!important}.container-md[_ngcontent-%COMP%]{max-width:960px}.py-6[_ngcontent-%COMP%]{padding-top:4.5rem;padding-bottom:4.5rem}.modal-content[_ngcontent-%COMP%]{background-color:#fff8e1}.modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #d97706}.modal-title[_ngcontent-%COMP%]{font-weight:500}.btn-close[_ngcontent-%COMP%]{filter:invert(27%) sepia(51%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%)}"]})};export{be as Panier};
